<nav>
  <ul class="pager">
    <li class="previous"><a href="/daily/{{offset - 1}}">&larr; {{prevDay}}</a></li>
    <li class="page-title">{{today}}</li>
    <li class="next"><a href="/daily/{{offset + 1}}">{{nextDay}} &rarr;</a></li>
  </ul>
</nav>

<div class="toolbar">
  <button class="btn btn-success btn-sm" type="submit" ng-click="showAddBill()">
    <span class="glyphicon glyphicon-plus"></span>
    添加
  </button>
</div>

<table class="table table-striped table-bordered table-hover">
  <thead>
    <tr>
      <th>
        #
      </th>
      <th>类型</th>
      <th>描述</th>
      <th>开始时间</th>
      <th>结束时间</th>
      <th>时长</th>
      <th width="140">操作</th>
    </tr>
  </thead>
  <tbody>
    <tr ng-repeat="timebill in timeBills">
      <td>
        {{$index + 1}}
      </td>
      <td>{{timebill.typeName}}</td>
      <td>{{timebill.detail}}</td>
      <td>{{timebill.startTime | date : 'HH:mm'}}</td>
      <td>{{timebill.endTime | date : 'HH:mm'}}</td>
      <td>{{formatDurationTime(timebill.durationTime)}}</td>
      <td>
        <button class="btn btn-info btn-xs" type="submit" ng-click="showEditBill(timebill)">
          <span class="glyphicon glyphicon-edit"></span>
          编辑
        </button>
        <button class="btn btn-danger btn-xs" type="submit" ng-click="showConfirmDeleteBill(timebill)">
          <span class="glyphicon glyphicon-remove"></span>
          删除
        </button>
      </td>
    </tr>
  </tbody>
</table>

<div>
  <p>
    <span><strong>总计</strong></span>
    <span>{{formatDurationTime(totalTime)}}</span>
  </p>

  <div class="progress" ng-repeat="type in types">

    <div class="progress-bar progress-bar-{{getProgressColorByRank($index)}} progress-bar-striped" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: {{type.dailyTime*100/totalTime}}%;min-width:100px;">
      <span>{{type.typeName}}: {{formatDurationTime(type.dailyTime)}}</span>
    </div>
  </div>
</div>

<!-- add record modal -->
<div id="timeBillModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">{{actionName}}时间账单</h4>
      </div>
      <div class="modal-body">
        <form class="form-horizontal">
          <div class="form-group">
            <label for="recipient-name" class="control-label col-sm-2">类型:</label>
            <div class="col-sm-10">
              <select id="type" class="form-control" ng-model="timeBill.typeId" ng-options="billType.id as billType.name for billType in billTypes">
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="message-text" class="control-label col-sm-2">描述:</label>
            <div class="col-sm-10">
              <textarea id="detail" class="form-control" ng-model="timeBill.detail"></textarea>
            </div>
          </div>
          <div class="form-group">
            <label for="recipient-name" class="control-label col-sm-2">开始时间:</label>
            <div class="col-sm-10">
              <div class="dropdown">
                <a class="dropdown-toggle" id="dropdown-start" role="button" data-toggle="dropdown" data-target="#" href="#">
                  <div class="input-group">
                    <input type="text" data-date-time-input="YYYY-MM-DD HH:mm" class="form-control" data-ng-model="timeBill.startTime">
                    <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                  </div>
                </a>
                <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                  <datetimepicker data-ng-model="timeBill.startTime" data-on-set-time="timeChanged()" data-before-render="beforeDatePickerRender($view, $dates, $leftDate, $upDate, $rightDate)" data-datetimepicker-config="{ dropdownSelector: '#dropdown-start' }"/>
                </ul>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label for="recipient-name" class="control-label col-sm-2">结束时间:</label>
            <div class="col-sm-10">
              <div class="dropdown">
                <a class="dropdown-toggle" id="dropdown-end" role="button" data-toggle="dropdown" data-target="#" href="#">
                  <div class="input-group">
                    <input type="text" data-date-time-input="YYYY-MM-DD HH:mm" class="form-control" data-ng-model="timeBill.endTime">
                    <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                  </div>
                </a>
                <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                  <datetimepicker data-ng-model="timeBill.endTime" data-on-set-time="timeChanged()" data-before-render="beforeDatePickerRender($view, $dates, $leftDate, $upDate, $rightDate)" data-datetimepicker-config="{ dropdownSelector: '#dropdown-end' }"/>
                </ul>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label for="recipient-name" class="control-label col-sm-2">时长:</label>
            <div class="col-sm-10">
              <input id="duration-time" type="text" class="form-control" value="{{formatDurationTime(timeBill.durationTime)}}" disabled >
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer modal-footer-center">
        <button type="button" class="btn btn-primary" ng-click="saveTimeBill()">
          <span class="glyphicon glyphicon-ok"></span>
          确认
        </button>
        <button type="button" class="btn btn-default" data-dismiss="modal">
          <span class="glyphicon glyphicon-remove"></span>
          取消
        </button>
      </div>
    </div>
  </div>
</div>

<!-- delete time-bill modal -->
<div id="deleteBillModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">提示</h4>
      </div>
      <div class="modal-body">
        是否确认删除该账单？
      </div>
      <div class="modal-footer modal-footer-center">
        <button type="button" class="btn btn-primary" ng-click="deleteBill(timeBill.id)">
          <span class="glyphicon glyphicon-ok"></span>
          确认
        </button>
        <button type="button" class="btn btn-danger" data-dismiss="modal">
          <span class="glyphicon glyphicon-remove"></span>
          取消
        </button>
      </div>
    </div>
  </div>
</div>

<!-- complete time-bill modal -->
<div id="completeBillModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">提示</h4>
      </div>
      <div class="modal-body">
        是否确认完成该账单？
      </div>
      <div class="modal-footer modal-footer-center">
        <button type="button" class="btn btn-primary" ng-click="deleteBill(timeBill.id)">
          <span class="glyphicon glyphicon-ok"></span>
          确认
        </button>
        <button type="button" class="btn btn-danger" data-dismiss="modal">
          <span class="glyphicon glyphicon-remove"></span>
          取消
        </button>
      </div>
    </div>
  </div>
</div>
